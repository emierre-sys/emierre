<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perigos Noturnos - Evento</title>
  
  <!-- Meta tags para compartilhamento -->
  <meta property="og:title" content="Confira este evento incr√≠vel!">
  <meta property="og:description" content="Algu√©m compartilhou um evento do Perigos Noturnos com voc√™. Toque para ver mais detalhes!">
  <meta property="og:image" content="https://emierre-sys.github.io/perigosnoturnos/assets/share-image.png">
  <meta property="og:url" content="https://emierre-sys.github.io/perigosnoturnos/eventos/">
  <meta property="og:type" content="website">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Evento - Perigos Noturnos">
  <meta name="twitter:description" content="Descubra este evento incr√≠vel!">
  <meta name="twitter:image" content="https://emierre-sys.github.io/perigosnoturnos/assets/share-image.png">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #000000, #1a1a1a, #cc0000);
      color: #ffffff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
    }
    
    .container {
      text-align: center;
      max-width: 400px;
      width: 100%;
    }
    
    .logo {
      font-size: 2.5rem;
      font-weight: bold;
      color: #cc0000;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    
    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid #333;
      border-top: 4px solid #cc0000;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .message {
      font-size: 1.2rem;
      margin-bottom: 30px;
      line-height: 1.5;
    }
    
    .subtitle {
      font-size: 0.9rem;
      color: #cccccc;
      margin-bottom: 40px;
    }
    
    .buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 30px;
    }
    
    .btn {
      padding: 15px 30px;
      font-size: 1rem;
      font-weight: bold;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background: linear-gradient(45deg, #cc0000, #ff3333);
      color: white;
      box-shadow: 0 4px 15px rgba(204, 0, 0, 0.3);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(204, 0, 0, 0.4);
    }
    
    .btn-secondary {
      background: transparent;
      color: #cccccc;
      border: 2px solid #555;
    }
    
    .btn-secondary:hover {
      background: #555;
      color: white;
    }
    
    .error-message {
      background: rgba(204, 0, 0, 0.1);
      border: 1px solid #cc0000;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    
    .icon {
      font-size: 3rem;
      margin-bottom: 20px;
      opacity: 0.8;
    }
    
    #status {
      margin-top: 20px;
      font-size: 0.9rem;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">Perigos Noturnos</div>
    
    <div id="loading" style="display: block;">
      <div class="loading-spinner"></div>
      <div class="message">Verificando evento...</div>
      <div class="subtitle">Aguarde um momento</div>
    </div>
    
    <div id="app-redirect" style="display: none;">
      <div class="icon">üì±</div>
      <div class="message">Abrindo no aplicativo...</div>
      <div class="subtitle">Se o app n√£o abrir automaticamente, use os bot√µes abaixo</div>
      
      <div class="buttons">
        <a href="#" id="open-app-btn" class="btn btn-primary">Abrir no App</a>
        <a href="https://play.google.com/store/apps/details?id=com.emierre.perigosnoturnos" class="btn btn-secondary" target="_blank">Baixar da Play Store</a>
        <a href="https://apps.apple.com/app/perigosnoturnos" class="btn btn-secondary" target="_blank">Baixar da App Store</a>
      </div>
    </div>
    
    <div id="no-app" style="display: none;">
      <div class="icon">üéâ</div>
      <div class="message">Evento encontrado!</div>
      <div class="subtitle">Baixe o aplicativo para participar deste evento incr√≠vel</div>
      
      <div class="buttons">
        <a href="https://play.google.com/store/apps/details?id=com.emierre.perigosnoturnos" class="btn btn-primary" target="_blank">Baixar para Android</a>
        <a href="https://apps.apple.com/app/perigosnoturnos" class="btn btn-primary" target="_blank">Baixar para iOS</a>
      </div>
    </div>
    
    <div id="error" style="display: none;">
      <div class="error-message">
        <div class="icon">‚ùå</div>
        <div class="message">Evento n√£o encontrado</div>
        <div class="subtitle">Verifique se o link est√° correto ou se o evento ainda est√° dispon√≠vel</div>
      </div>
      
      <div class="buttons">
        <a href="https://play.google.com/store/apps/details?id=com.emierre.perigosnoturnos" class="btn btn-primary" target="_blank">Baixar App</a>
        <button onclick="location.reload()" class="btn btn-secondary">Tentar Novamente</button>
      </div>
    </div>
    
    <div id="status"></div>
  </div>

  <script>
    // Configura√ß√µes
    const APP_SCHEME = 'perigosnoturnos://';
    const ANDROID_PACKAGE = 'com.emierre.perigosnoturnos';
    const IOS_APP_ID = 'id123456789'; // Substitua pelo ID real do seu app
    
    // Elementos DOM
    const loadingEl = document.getElementById('loading');
    const appRedirectEl = document.getElementById('app-redirect');
    const noAppEl = document.getElementById('no-app');
    const errorEl = document.getElementById('error');
    const statusEl = document.getElementById('status');
    const openAppBtn = document.getElementById('open-app-btn');
    
    // Fun√ß√£o principal
    function init() {
      const eventId = getEventId();
      
      if (!eventId) {
        showError('ID do evento n√£o encontrado na URL');
        return;
      }
      
      updateStatus(`Evento ID: ${eventId}`);
      
      // Simular verifica√ß√£o do evento (voc√™ pode implementar uma verifica√ß√£o real via API)
      setTimeout(() => {
        hideLoading();
        attemptAppOpen(eventId);
      }, 2000);
    }
    
    // Extrair ID do evento da URL
    function getEventId() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('id');
    }
    
    // Tentar abrir o aplicativo
    function attemptAppOpen(eventId) {
      const deepLink = `${APP_SCHEME}evento/${eventId}`;
      
      // Configurar o bot√£o para tentar abrir o app novamente
      openAppBtn.href = deepLink;
      
      // Detectar plataforma
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
      const isAndroid = /Android/.test(navigator.userAgent);
      
      if (isIOS || isAndroid) {
        showAppRedirect();
        
        // Tentar abrir o app imediatamente
        window.location.href = deepLink;
        
        // Fallback ap√≥s 3 segundos
        setTimeout(() => {
          if (isIOS) {
            // Tentar App Store no iOS
            window.location.href = `https://apps.apple.com/app/${IOS_APP_ID}`;
          } else if (isAndroid) {
            // Tentar Play Store no Android
            window.location.href = `https://play.google.com/store/apps/details?id=${ANDROID_PACKAGE}`;
          }
        }, 3000);
        
      } else {
        // Desktop - mostrar op√ß√µes de download
        showNoApp();
      }
    }
    
    // Fun√ß√µes de UI
    function hideLoading() {
      loadingEl.style.display = 'none';
    }
    
    function showAppRedirect() {
      appRedirectEl.style.display = 'block';
    }
    
    function showNoApp() {
      noAppEl.style.display = 'block';
    }
    
    function showError(message) {
      hideLoading();
      errorEl.style.display = 'block';
      errorEl.querySelector('.subtitle').textContent = message;
    }
    
    function updateStatus(message) {
      statusEl.textContent = message;
    }
    
    // Detectar se o usu√°rio voltou para a p√°gina (app n√£o abriu)
    let hidden = false;
    
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        hidden = true;
      } else if (hidden) {
        // Usu√°rio voltou - app provavelmente n√£o abriu
        updateStatus('App n√£o encontrado - redirecionando para loja...');
      }
    });
    
    // Detectar blur/focus para tentar identificar se o app abriu
    window.addEventListener('blur', function() {
      setTimeout(() => {
        updateStatus('Tentando abrir o aplicativo...');
      }, 100);
    });
    
    window.addEventListener('focus', function() {
      setTimeout(() => {
        updateStatus('App n√£o abriu - use os bot√µes para baixar');
      }, 500);
    });
    
    // Inicializar quando a p√°gina carregar
    document.addEventListener('DOMContentLoaded', init);
    
    // Fallback se DOMContentLoaded j√° passou
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>